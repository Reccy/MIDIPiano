language: cpp

compiler:
  - clang
  - gcc

branches:
  only:
    - master
    - travis-test

before_install:
  - mkdir build
  - cd build
  - cmake ..

install:
  - make
  - chmod +x MidiPianoTestRunner

script:
  - ./MidiPianoTestRunner

jobs:
  include:
    - stage: "Tests"
      script: ./MidiPianoTestRunner
    - stage: "Deploy to GitHub"
      deploy:
        provider: releases
        api_key: $GITHUB_OAUTH_TOKEN
        skip_cleanup: true
        on:
          tags: true
